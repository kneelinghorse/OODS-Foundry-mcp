# R28.1 Separation of Duty (SoD) Test Cases

This document outlines a set of test cases for verifying the implementation of Separation of Duty (SoD) policies.

## 1.0 Static SoD Test Cases

### 1.1 Test Case: SSoD_001

*   **Description:** Attempt to assign a conflicting role to a user who already has a role that is part of a conflicting pair.
*   **Policy:** A user cannot be both a "Payment Initiator" and a "Payment Authorizer".
*   **Steps:**
    1.  Create a user.
    2.  Assign the "Payment Initiator" role to the user.
    3.  Attempt to assign the "Payment Authorizer" role to the same user.
*   **Expected Result:** The assignment should fail with an SoD violation error.

### 1.2 Test Case: SSoD_002

*   **Description:** Attempt to assign a role to a user that is not part of any conflicting pair.
*   **Policy:** A user cannot be both a "Payment Initiator" and a "Payment Authorizer".
*   **Steps:**
    1.  Create a user.
    2.  Assign the "Payment Initiator" role to the user.
    3.  Attempt to assign a non-conflicting role (e.g., "Auditor") to the same user.
*   **Expected Result:** The assignment should succeed.

## 2.0 Dynamic SoD Test Cases

### 2.1 Test Case: DSoD_001

*   **Description:** A user with conflicting permissions attempts to execute a conflicting action within the same session.
*   **Policy:** A user cannot both create a purchase order and approve the same purchase order.
*   **Steps:**
    1.  Create a user with both the "Purchase Order Creator" and "Purchase Order Approver" roles.
    2.  The user creates a purchase order.
    3.  The same user attempts to approve the purchase order they just created.
*   **Expected Result:** The approval should fail with an SoD violation error.

### 2.2 Test Case: DSoD_002

*   **Description:** A user with conflicting permissions has another user approve their action.
*   **Policy:** A user cannot both create a purchase order and approve the same purchase order.
*   **Steps:**
    1.  Create two users, User A and User B.
    2.  Assign both the "Purchase Order Creator" and "Purchase Order Approver" roles to both users.
    3.  User A creates a purchase order.
    4.  User B attempts to approve the purchase order created by User A.
*   **Expected Result:** The approval should succeed.

## 3.0 Quorum-based SoD Test Cases

### 3.1 Test Case: QSoD_001

*   **Description:** Attempt to execute a sensitive action without enough approvals.
*   **Policy:** A financial transaction over $10,000 requires approval from at least 3 out of 5 managers.
*   **Steps:**
    1.  A user initiates a financial transaction of $15,000.
    2.  Two managers approve the transaction.
    3.  The system attempts to execute the transaction.
*   **Expected Result:** The transaction should not be executed and should remain in a "pending approval" state.

### 3.2 Test Case: QSoD_002

*   **Description:** Execute a sensitive action after enough approvals have been received.
*   **Policy:** A financial transaction over $10,000 requires approval from at least 3 out of 5 managers.
*   **Steps:**
    1.  A user initiates a financial transaction of $15,000.
    2.  Three managers approve the transaction.
    3.  The system attempts to execute the transaction.
*   **Expected Result:** The transaction should be executed successfully.
